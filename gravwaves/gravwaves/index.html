


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.0">
    
    
      
        <title>Gravitational Wave Parameter Estimation with bilby - Demonstrations of MCMC and Nested Samplers in Physics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.b5d04df8.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-bilby-with-dynesty-to-estimate-the-properties-of-the-first-ever-detected-gravitational-wave-signal" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Demonstrations of MCMC and Nested Samplers in Physics" class="md-header-nav__button md-logo" aria-label="Demonstrations of MCMC and Nested Samplers in Physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Demonstrations of MCMC and Nested Samplers in Physics
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Gravitational Wave Parameter Estimation with bilby
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Demonstrations of MCMC and Nested Samplers in Physics" class="md-nav__button md-logo" aria-label="Demonstrations of MCMC and Nested Samplers in Physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Demonstrations of MCMC and Nested Samplers in Physics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../PyMC3_GRS/PyMC3_GRS/" title="Gamma-Ray Spectroscopy with PyMC3 and dynesty" class="md-nav__link">
      Gamma-Ray Spectroscopy with PyMC3 and dynesty
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../LightCurve/LightCurve/" title="Exoplanet Light Curve Analysis with emcee and UltraNest" class="md-nav__link">
      Exoplanet Light Curve Analysis with emcee and UltraNest
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Sunspots2/Sunspots2/" title="Solar Cycle Analysis with Zeus and Nestle" class="md-nav__link">
      Solar Cycle Analysis with Zeus and Nestle
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Gravitational Wave Parameter Estimation with bilby
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Gravitational Wave Parameter Estimation with bilby" class="md-nav__link md-nav__link--active">
      Gravitational Wave Parameter Estimation with bilby
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#useful-imports" class="md-nav__link">
    Useful imports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viewing-the-data" class="md-nav__link">
    Viewing the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-the-priors" class="md-nav__link">
    Setting the priors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-the-likelihood" class="md-nav__link">
    Setting the likelihood
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sampling-the-data" class="md-nav__link">
    Sampling the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotting-the-posterior" class="md-nav__link">
    Plotting the posterior
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estimating-the-black-hole-masses" class="md-nav__link">
    Estimating the black hole masses
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../particleID/particleID/" title="Particle Identification in Proton-Proton Collisions with PyStan and DNest4" class="md-nav__link">
      Particle Identification in Proton-Proton Collisions with PyStan and DNest4
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../TheOnlineMCMC/TheOnlineMCMC/" title="Zero Installation Sampling with The Online MCMC" class="md-nav__link">
      Zero Installation Sampling with The Online MCMC
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#useful-imports" class="md-nav__link">
    Useful imports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viewing-the-data" class="md-nav__link">
    Viewing the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-the-priors" class="md-nav__link">
    Setting the priors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-the-likelihood" class="md-nav__link">
    Setting the likelihood
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sampling-the-data" class="md-nav__link">
    Sampling the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotting-the-posterior" class="md-nav__link">
    Plotting the posterior
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estimating-the-black-hole-masses" class="md-nav__link">
    Estimating the black hole masses
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="using-bilby-with-dynesty-to-estimate-the-properties-of-the-first-ever-detected-gravitational-wave-signal">Using bilby with dynesty to estimate the properties of the first ever detected gravitational wave signal</h1>
<p>Einstein's theory of General Relativity, 1916, predicted that space-time can act as a medium for <a href="https://en.wikipedia.org/wiki/Gravitational_wave">"gravitational waves"</a>, which are ripples caused by extremely violent cosmic events such as black holes or neutron stars colliding. Einstein predicted that these waves travel at the speed of light, and could carry information about the event that caused them, and perhaps even reveal the "true" nature of gravity. He also predicted that the waves would be so small, that their presence would never be detected. However, almost 100 years later in 2015, <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.116.061102">LIGO detected the first gravitational wave signal</a> "GW150914" using a 4km long interferometer, the arms of which only stretched by a thousandth the width of a proton. </p>
<p>The event that caused the gravitational waves was a merger of two massive black holes. In this example, I'll use the gravitational wave analysis package <a href="https://lscsoft.docs.ligo.org/bilby/index.html">"bilby"</a> along with the sampler "dynesty" to find the mass of the two black holes that caused GW150914.</p>
<h2 id="useful-imports">Useful imports</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># sampler</span>
<span class="kn">import</span> <span class="nn">bilby</span>
<span class="kn">from</span> <span class="nn">bilby.core.prior</span> <span class="kn">import</span> <span class="n">Uniform</span>

<span class="c1"># misc</span>
<span class="kn">from</span> <span class="nn">gwpy.timeseries</span> <span class="kn">import</span> <span class="n">TimeSeries</span>
</code></pre></div>


<h2 id="viewing-the-data">Viewing the data</h2>
<p>Bilby has in-built features that allow us to view the data that we'll be using. To do this, we have to set up interferometer objects that contain the data we'll be using. The data in question is made up of a strain dataset which contains the information of the waveform, and a Power Spectral Density (PSD) dataset which approximates the noise. </p>
<p>We start by defining a directory for bilby to save results, and defining the source we want to analyse, and creating some empty interferometer objects to store the data:</p>
<div class="codehilite"><pre><span></span><code><span class="n">logger</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">logger</span>
<span class="n">outdir</span> <span class="o">=</span> <span class="s2">&quot;outdir&quot;</span>
<span class="c1"># gravitational wave source</span>
<span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;GW150914&quot;</span>  

<span class="n">H1</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">get_empty_interferometer</span><span class="p">(</span><span class="s2">&quot;H1&quot;</span><span class="p">)</span>
<span class="n">L1</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">get_empty_interferometer</span><span class="p">(</span><span class="s2">&quot;L1&quot;</span><span class="p">)</span>
</code></pre></div>


<p>To obtain the data, a time range around the event has to be defined and passed to <a href="https://gwpy.github.io/">"gwpy"</a>, which will download the data for us from <a href="https://www.gw-openscience.org/eventapi/html/GWTC-1-confident/GW150914/v3/">here</a>.</p>
<div class="codehilite"><pre><span></span><code><span class="n">event_start_time</span> <span class="o">=</span> <span class="mf">1126259462.4</span>    <span class="c1"># event GPS time at which first GW discovered</span>
<span class="n">post_event</span> <span class="o">=</span> <span class="mi">2</span>                     <span class="c1"># time after event</span>
<span class="n">pre_event</span> <span class="o">=</span> <span class="mi">2</span>                      <span class="c1"># time before event</span>
<span class="n">duration</span> <span class="o">=</span> <span class="n">pre_event</span> <span class="o">+</span> <span class="n">post_event</span>  <span class="c1"># total time range containing event</span>
<span class="n">analysis_begin</span> <span class="o">=</span> <span class="n">event_start_time</span> <span class="o">-</span> <span class="n">pre_event</span>  <span class="c1"># GPS time at which to start analysis</span>
</code></pre></div>


<p>Using these time settings, we can fetch the data we want to analyse. Once the data is downloaded, we can use in-built plot functions to visualise what our data will look like. The two plots below show the strain data for Hanford and Livingston detectors respectively.</p>
<div class="codehilite"><pre><span></span><code><span class="n">H1_data</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">fetch_open_data</span><span class="p">(</span><span class="s2">&quot;H1&quot;</span><span class="p">,</span> <span class="n">analysis_begin</span><span class="p">,</span> 
                                     <span class="n">analysis_begin</span> <span class="o">+</span> <span class="n">duration</span><span class="p">,</span>
                                     <span class="n">sample_rate</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">L1_data</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">fetch_open_data</span><span class="p">(</span><span class="s2">&quot;L1&quot;</span><span class="p">,</span> <span class="n">analysis_begin</span><span class="p">,</span> 
                                     <span class="n">analysis_begin</span> <span class="o">+</span> <span class="n">duration</span><span class="p">,</span>
                                     <span class="n">sample_rate</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">H1_data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;H1_data&quot;</span><span class="p">)</span>
<span class="n">L1_data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;L1_data&quot;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="" src="../H1_analysis.png" /></p>
<p><img alt="" src="../L1_analysis.png" title="Title" /></p>
<p>We can also check out the PSD data that we'll be using to estimate noise in the data. Again using gwpy, the data can be obtained as follows: </p>
<div class="codehilite"><pre><span></span><code><span class="c1"># duration typically multiplied by 32 for psd</span>
<span class="n">psd_duration</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">*</span> <span class="mi">32</span>                
<span class="n">psd_begin</span> <span class="o">=</span> <span class="n">analysis_start</span> <span class="o">-</span> <span class="n">psd_duration</span>

<span class="c1"># fetch data for psd</span>
<span class="n">H1psd</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">fetch_open_data</span><span class="p">(</span>
    <span class="s2">&quot;H1&quot;</span><span class="p">,</span> <span class="n">psd_begin</span><span class="p">,</span> <span class="n">psd_begin</span> <span class="o">+</span> <span class="n">psd_duration</span><span class="p">,</span>
    <span class="n">sample_rate</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">L1psd</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">fetch_open_data</span><span class="p">(</span>
    <span class="s2">&quot;L1&quot;</span><span class="p">,</span> <span class="n">psd_begin</span><span class="p">,</span> <span class="n">psd_begin</span> <span class="o">+</span> <span class="n">psd_duration</span><span class="p">,</span>
    <span class="n">sample_rate</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># set interferometers with psd data</span>
<span class="n">psd_alpha</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">H1</span><span class="o">.</span><span class="n">strain_data</span><span class="o">.</span><span class="n">roll_off</span> <span class="o">/</span> <span class="n">duration</span>
<span class="n">H1psd_data</span> <span class="o">=</span> <span class="n">H1psd</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">fftlength</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;tukey&quot;</span><span class="p">,</span> <span class="n">psd_alpha</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="n">L1psd_data</span> <span class="o">=</span> <span class="n">L1psd</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">fftlength</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;tukey&quot;</span><span class="p">,</span> <span class="n">psd_alpha</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="n">H1</span><span class="o">.</span><span class="n">power_spectral_density</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">PowerSpectralDensity</span><span class="p">(</span>
    <span class="n">frequency_array</span><span class="o">=</span><span class="n">H1psd_data</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">psd_array</span><span class="o">=</span><span class="n">H1psd_data</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">L1</span><span class="o">.</span><span class="n">power_spectral_density</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">PowerSpectralDensity</span><span class="p">(</span>
    <span class="n">frequency_array</span><span class="o">=</span><span class="n">L1psd_data</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">psd_array</span><span class="o">=</span><span class="n">L1psd_data</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>


<p>Before plotting the PSD, its useful to set an upper frequency limit as higher frequencies aren't so useful. After limiting the frequency, we can plot the PSD data:</p>
<div class="codehilite"><pre><span></span><code><span class="n">H1</span><span class="o">.</span><span class="n">maximum_frequency</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">L1</span><span class="o">.</span><span class="n">maximum_frequency</span> <span class="o">=</span> <span class="mi">1024</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">H1</span><span class="o">.</span><span class="n">strain_data</span><span class="o">.</span><span class="n">frequency_mask</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">H1</span><span class="o">.</span><span class="n">strain_data</span><span class="o">.</span><span class="n">frequency_array</span><span class="p">[</span><span class="n">idxs</span><span class="p">]),</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H1</span><span class="o">.</span><span class="n">strain_data</span><span class="o">.</span><span class="n">frequency_domain_strain</span><span class="p">[</span><span class="n">idxs</span><span class="p">]))</span>
<span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">H1</span><span class="o">.</span><span class="n">power_spectral_density</span><span class="o">.</span><span class="n">frequency_array</span><span class="p">[</span><span class="n">idxs</span><span class="p">]),</span><span class="nb">list</span><span class="p">(</span><span class="n">H1</span><span class="o">.</span><span class="n">power_spectral_density</span><span class="o">.</span><span class="n">asd_array</span><span class="p">[</span><span class="n">idxs</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Frequency [Hz]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Strain [strain/$\sqrt</span><span class="si">{Hz}</span><span class="s2">$]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;strainvfreq&quot;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="" src="../strainvfreq.png" /></p>
<h2 id="setting-the-priors">Setting the priors</h2>
<p>The model describing the black hole merger depends on 15 parameters. Running a sampler with this many parameters can take half a day to run. To save some time, I'll fix all but 4 parameters: the chirp mass, the mass ratio, the phase, and the geocent time.</p>
<p>The chirp mass and mass ratio are two parameters which depend only on the mass of the two black holes that caused the gravitational waves. When these two parameters are derived, we can use them to calculate the masses of the black holes. Since we don't know much about the system parameters that we're allowing to vary, uniform priors are most appropriate:</p>
<div class="codehilite"><pre><span></span><code><span class="n">prior</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">PriorDict</span><span class="p">()</span>
<span class="c1"># uniform priors for variable parameters</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;chirp_mass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;chirp_mass&#39;</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">maximum</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;mass_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mass_ratio&#39;</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;phase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;geocent_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geocent_time&quot;</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="n">event_start_time</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
                                <span class="n">maximum</span><span class="o">=</span><span class="n">event_start_time</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
<span class="c1"># fixed values for all other parameters</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;a_1&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0</span>     
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;a_2&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;tilt_1&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;tilt_2&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;phi_12&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;phi_jl&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">1.2232</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">2.19432</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;theta_jn&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.89694</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;psi&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.532268</span>
<span class="n">prior</span><span class="p">[</span><span class="s1">&#39;luminosity_distance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">412.066</span>
</code></pre></div>


<h2 id="setting-the-likelihood">Setting the likelihood</h2>
<p>Bilby comes with in-built likelihood functions. To use them, first a waveform has to be generated using the properties of the data, like duration and sampling frequency. We also need to combine the interferometers into a list, so that both will be used at once when it comes to sampling.</p>
<div class="codehilite"><pre><span></span><code><span class="n">interferometers</span> <span class="o">=</span> <span class="p">[</span><span class="n">H1</span><span class="p">,</span> <span class="n">L1</span><span class="p">]</span>

<span class="n">waveform_arguments</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">waveform_approximant</span><span class="o">=</span><span class="s1">&#39;IMRPhenomPv2&#39;</span><span class="p">,</span>
                          <span class="n">reference_frequency</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">minimum_frequency</span><span class="o">=</span><span class="mf">20.</span><span class="p">)</span>

<span class="c1"># set sampling frequency of data</span>
<span class="n">sampling_frequency</span> <span class="o">=</span> <span class="mf">2048.</span>

<span class="c1"># generate waveforms</span>
<span class="n">waveform_generator</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">WaveformGenerator</span><span class="p">(</span>
    <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">sampling_frequency</span><span class="o">=</span><span class="n">sampling_frequency</span><span class="p">,</span>
    <span class="n">frequency_domain_source_model</span><span class="o">=</span><span class="n">bilby</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">lal_binary_black_hole</span><span class="p">,</span>
    <span class="n">parameter_conversion</span><span class="o">=</span><span class="n">bilby</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">convert_to_lal_binary_black_hole_parameters</span><span class="p">,</span>
    <span class="n">waveform_arguments</span><span class="o">=</span><span class="n">waveform_arguments</span><span class="p">)</span>

<span class="n">likelihood</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">GravitationalWaveTransient</span><span class="p">(</span>
    <span class="n">interferometers</span><span class="o">=</span><span class="n">interferometers</span><span class="p">,</span> <span class="n">waveform_generator</span><span class="o">=</span><span class="n">waveform_generator</span><span class="p">)</span>
</code></pre></div>


<h2 id="sampling-the-data">Sampling the data</h2>
<p>Now that the likelihood and prior functions are set up, the sampler can now be implemented to derive some of the properties of the binary black hole system. This process is intensive, and takes a long time (1 hour 15 minutes) to run on my machine. </p>
<p>The sampler I chose to use is "dynesty", which uses nested sampling to estimate the model parameters. For a more in-depth work through of dynesty, you can read through an example of <a href="https://mo-ghani.github.io/Sampling/PyMC3_GRS/PyMC3_GRS/#modelling-with-dynesty">gamma-ray spectroscopy using dynesty</a> on this site.</p>
<p>Using bilby, we can run the sampler. First, we have to set the number of live points, and the stopping criterion as hyperparameters. For neatness, I've removed the log that bilby outputs whilst running. Instead, I'll just show the summary that is outputted by bilby once the sampler has finished iterating. This summary contains information on the log evidence, and the Bayes factor of the model.</p>
<div class="codehilite"><pre><span></span><code><span class="n">nlive</span> <span class="o">=</span> <span class="mi">1000</span>          <span class="c1"># live points</span>
<span class="n">stop</span> <span class="o">=</span> <span class="mf">0.1</span>            <span class="c1"># stopping criterion</span>
<span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;unif&quot;</span>       <span class="c1"># method of sampling</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="s2">&quot;dynesty&quot;</span>   <span class="c1"># sampler to use</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">run_sampler</span><span class="p">(</span>
    <span class="n">likelihood</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="n">outdir</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
    <span class="n">conversion_function</span><span class="o">=</span><span class="n">bilby</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">generate_all_bbh_parameters</span><span class="p">,</span>
    <span class="n">sample</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">nlive</span><span class="o">=</span><span class="n">nlive</span><span class="p">,</span> <span class="n">dlogz</span><span class="o">=</span><span class="n">stop</span><span class="p">)</span> 
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="mi">16</span><span class="p">:</span><span class="mi">23</span> <span class="n">bilby</span> <span class="n">INFO</span>    <span class="p">:</span> <span class="n">Sampling</span> <span class="n">time</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mf">43.878674</span>
<span class="mi">16</span><span class="p">:</span><span class="mi">23</span> <span class="n">bilby</span> <span class="n">INFO</span>    <span class="p">:</span> <span class="n">Summary</span> <span class="n">of</span> <span class="n">results</span><span class="p">:</span>
                      <span class="n">nsamples</span><span class="p">:</span> <span class="mi">23105</span>
                      <span class="n">ln_noise_evidence</span><span class="p">:</span> <span class="o">-</span><span class="mf">8112.144</span>
                      <span class="n">ln_evidence</span><span class="p">:</span> <span class="o">-</span><span class="mf">8729.851</span> <span class="o">+/-</span>  <span class="mf">0.188</span>
                      <span class="n">ln_bayes_factor</span><span class="p">:</span> <span class="o">-</span><span class="mf">617.707</span> <span class="o">+/-</span>  <span class="mf">0.188</span>
</code></pre></div>


<h2 id="plotting-the-posterior">Plotting the posterior</h2>
<p>Eventually, the sampling will be complete. Bilby creates a few useful plots of the posteriors, along with saving samples of the posteriors for us to further analyse. Lets start by plotting a corner plot, which nicely shows the posteriors for all the parameters, as well as contour plots showing how one parameter varies with any other.</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span><span class="o">.</span><span class="n">plot_corner</span><span class="p">()</span>
</code></pre></div>


<p><img alt="" src="../GWSampleDemo_corner.png" /></p>
<p>We can also view the traces for each parameter, which bilby will save by default under the directory labeled as "outdir":</p>
<p><img alt="" src="../GWSampleDemo_checkpoint_trace.png" /></p>
<h2 id="estimating-the-black-hole-masses">Estimating the black hole masses</h2>
<p>To estimate the black hole masses, we need to obtain the samples describing the posteriors of the data. This can be done quite easily as bilby returns the posterior samples. Alternatively, bilby also saves posterior samples to a text file, which can be loaded using pandas. I'll use the latter method, so I don't have to re-run the sampler.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># load posterior samples into a pandas dataframe directly</span>
<span class="c1"># posts = result.posterior</span>

<span class="c1"># alternatively, load posts using samples saved by bilby using pandas</span>
<span class="n">posts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;GWSampleDemo_samples.dat&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>

<span class="n">chirp_mass_samps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">posts</span><span class="p">[</span><span class="s2">&quot;chirp_mass&quot;</span><span class="p">])</span>
<span class="n">mass_ratio_samps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">posts</span><span class="p">[</span><span class="s2">&quot;mass_ratio&quot;</span><span class="p">])</span>
<span class="n">geocent_time_samps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">posts</span><span class="p">[</span><span class="s2">&quot;geocent_time&quot;</span><span class="p">])</span>
</code></pre></div>


<p>Next, we can take the posterior samples and find their mean values:</p>
<div class="codehilite"><pre><span></span><code><span class="n">chirp_mass</span><span class="p">,</span> <span class="n">chirp_mass_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">chirp_mass_samps</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">chirp_mass_samps</span><span class="p">)</span>
<span class="n">mass_ratio</span><span class="p">,</span> <span class="n">mass_ratio_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mass_ratio_samps</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">mass_ratio_samps</span><span class="p">)</span>
<span class="n">geocent_time</span><span class="p">,</span> <span class="n">geocent_time_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">geocent_time_samps</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">geocent_time_samps</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parameters describing the GW150914 signal: </span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
      <span class="s2">&quot;  chirp mass = </span><span class="si">{}</span><span class="s2">   </span><span class="se">\u00B1</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chirp_mass</span><span class="p">,</span> <span class="n">chirp_mass_err</span><span class="p">)</span> <span class="o">+</span> 
      <span class="s2">&quot;  mass ratio = </span><span class="si">{}</span><span class="s2"> </span><span class="se">\u00B1</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mass_ratio</span><span class="p">,</span> <span class="n">mass_ratio_err</span><span class="p">)</span> <span class="o">+</span> 
      <span class="s2">&quot;geocent time = </span><span class="si">{}</span><span class="s2"> </span><span class="se">\u00B1</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geocent_time</span><span class="p">,</span> <span class="n">geocent_time_err</span><span class="p">)</span> <span class="o">+</span> 
      <span class="s2">&quot;True geocent time = 1126259462.4&quot;</span><span class="p">)</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>Parameters describing the GW150914 signal:

  chirp mass = 28.432363440275488   ± 0.049549938503053295 
  mass ratio = 0.7520294836733314 ± 0.06062816795824152

geocent time = 1126259462.4128802 ± 7.509222877728134e-05 
True geocent time = 1126259462.4
</code></pre></div>

<p>The time of the event lines up quite nicely. Next, we can attempt to calculate the mass of each black hole, which is fairly straight forward now that we know the chirp mass and mass ratio. The following function will return the masses of the black holes, given the chirp mass, mass ratio, and their errors.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">bbhMass</span><span class="p">(</span><span class="n">chirp</span><span class="p">,</span><span class="n">chirperr</span><span class="p">,</span><span class="n">ratio</span><span class="p">,</span><span class="n">ratioerr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that calculates black hole masses with errors</span>

<span class="sd">    m1,m2 = larger black hole mass, smaller black hole mass </span>
<span class="sd">    chirp = (m1*m2)**(3/5) / (m1+m2)**(1/5)</span>
<span class="sd">    ratio = m2/m1</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># use chirp mass and ratio to find primary black hole mass</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">chirp</span> <span class="o">/</span> <span class="p">(</span><span class="n">ratio</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ratio</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">m1err</span> <span class="o">=</span> <span class="p">(</span><span class="n">chirp</span> <span class="o">+</span> <span class="n">chirperr</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">ratio</span><span class="o">-</span><span class="n">ratioerr</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span>
                                  <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">ratio</span><span class="o">+</span><span class="n">ratioerr</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)))</span> <span class="o">-</span> <span class="n">m1</span>

    <span class="c1"># use primary black hole mass and ratio to find secondary black hole mass</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">m1</span><span class="o">*</span><span class="n">ratio</span>
    <span class="n">m2err</span> <span class="o">=</span> <span class="p">(</span><span class="n">m1</span><span class="o">+</span><span class="n">m1err</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ratio</span><span class="o">+</span><span class="n">ratioerr</span><span class="p">)</span> <span class="o">-</span> <span class="n">m2</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">m1err</span><span class="p">),(</span><span class="n">m2</span><span class="p">,</span><span class="n">m2err</span><span class="p">)</span>

<span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">m1err</span><span class="p">),</span> <span class="p">(</span><span class="n">m2</span><span class="p">,</span><span class="n">m2err</span><span class="p">)</span> <span class="o">=</span> <span class="n">bbhMass</span><span class="p">(</span><span class="n">chirp_mass</span><span class="p">,</span><span class="n">chirp_mass_err</span><span class="p">,</span>
                                 <span class="n">mass_ratio</span><span class="p">,</span><span class="n">mass_ratio_err</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Black hole masses from sampling (in solar masses): </span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
      <span class="s2">&quot;   largest black hole = </span><span class="si">{}</span><span class="s2"> </span><span class="se">\u00B1</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m1err</span><span class="p">)</span> <span class="o">+</span> 
      <span class="s2">&quot;  smallest black hole = </span><span class="si">{}</span><span class="s2"> </span><span class="se">\u00B1</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">m2err</span><span class="p">)</span> <span class="o">+</span>
      <span class="s2">&quot;Accepted black hole masses (in solar masses): </span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> 
      <span class="s2">&quot;   largest black hole = </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">36.2</span><span class="p">)</span> <span class="o">+</span> 
      <span class="s2">&quot;  smallest black hole = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">29.1</span><span class="p">))</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code>Black hole masses from sampling (in solar masses):

   largest black hole = 37.73812541182669 ± 2.2926680096744576 
  smallest black hole = 28.38018296825545 ± 4.151147606610291

Accepted black hole masses (in solar masses):

   largest black hole = 36.2
  smallest black hole = 29.1
</code></pre></div>

<p>Our estimates here are within one standard deviation error of the accepted black hole masses. This is a good result given that we only used 4 of 15 parameters. However allowing the other 11 parameters to vary would certainly reduce the error on our estimate, at the cost of 15 hours processing time.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../Sunspots2/Sunspots2/" title="Solar Cycle Analysis with Zeus and Nestle" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Solar Cycle Analysis with Zeus and Nestle
              </div>
            </div>
          </a>
        
        
          <a href="../../particleID/particleID/" title="Particle Identification in Proton-Proton Collisions with PyStan and DNest4" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Particle Identification in Proton-Proton Collisions with PyStan and DNest4
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.92ffa368.min.js"></script>
      <script src="../../assets/javascripts/bundle.5123e3d4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>