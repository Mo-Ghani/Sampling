


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.0">
    
    
      
        <title>Demonstrations of MCMC and Nested Samplers in Physics</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.b5d04df8.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-uses-of-mcmc-and-nested-sampling-algorithms" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="." title="Demonstrations of MCMC and Nested Samplers in Physics" class="md-header-nav__button md-logo" aria-label="Demonstrations of MCMC and Nested Samplers in Physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Demonstrations of MCMC and Nested Samplers in Physics
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Introduction
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Demonstrations of MCMC and Nested Samplers in Physics" class="md-nav__button md-logo" aria-label="Demonstrations of MCMC and Nested Samplers in Physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Demonstrations of MCMC and Nested Samplers in Physics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Introduction
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="." title="Introduction" class="md-nav__link md-nav__link--active">
      Introduction
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-brief-introduction-to-bayesian-inference" class="md-nav__link">
    A Brief Introduction to Bayesian Inference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#markov-chain-monte-carlo" class="md-nav__link">
    Markov Chain Monte Carlo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nested-sampling" class="md-nav__link">
    Nested Sampling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-samplers" class="md-nav__link">
    The Samplers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-data" class="md-nav__link">
    The Data
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="PyMC3_GRS/PyMC3_GRS/" title="Gamma-Ray Spectroscopy with PyMC3 and dynesty" class="md-nav__link">
      Gamma-Ray Spectroscopy with PyMC3 and dynesty
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="LightCurve/LightCurve/" title="Exoplanet Light Curve Analysis with emcee and UltraNest" class="md-nav__link">
      Exoplanet Light Curve Analysis with emcee and UltraNest
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Sunspots2/Sunspots2/" title="Solar Cycle Analysis with Zeus and Nestle" class="md-nav__link">
      Solar Cycle Analysis with Zeus and Nestle
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="gravwaves/gravwaves/" title="Gravitational Wave Parameter Estimation with bilby" class="md-nav__link">
      Gravitational Wave Parameter Estimation with bilby
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="particleID/particleID/" title="Particle Identification in Proton-Proton Collisions with PyStan" class="md-nav__link">
      Particle Identification in Proton-Proton Collisions with PyStan
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-brief-introduction-to-bayesian-inference" class="md-nav__link">
    A Brief Introduction to Bayesian Inference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#markov-chain-monte-carlo" class="md-nav__link">
    Markov Chain Monte Carlo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nested-sampling" class="md-nav__link">
    Nested Sampling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-samplers" class="md-nav__link">
    The Samplers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-data" class="md-nav__link">
    The Data
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="the-uses-of-mcmc-and-nested-sampling-algorithms">The Uses Of MCMC and Nested Sampling Algorithms</h1>
<p>There are various off-the-shelf samplers that make use of MCMC and nested sampling algorithms in Python, freely available for the public to use. 
The following webpage is a collection of demonstrations of how a handful of popular samplers can be used to analyse real world, open source data sets. </p>
<ul>
<li>A github repository containing all the examples on this webpage can be found <a href="https://github.com/Mo-Ghani/Sampling">here</a></li>
<li>A Docker container containing all the samplers used on this webpage can be found <a href="https://hub.docker.com/r/mattpitkin/samplers/tags">here</a> </li>
</ul>
<h2 id="a-brief-introduction-to-bayesian-inference">A Brief Introduction to Bayesian Inference</h2>
<p>For any experiment, you might have some kind of belief on what the outcome should be. This belief can be tested by recording the results of the experiment, and finding the likelihood that your beliefs explain the observed data. Using this you can update your prior beliefs using <a href="https://en.wikipedia.org/wiki/Bayes%27_theorem#:~:text=In%20probability%20theory%20and%20statistics,be%20related%20to%20the%20event.">Bayes' rule</a>:</p>
<p>
<script type="math/tex; mode=display"> P(M|E) = \frac{P(E|M) P(M)}{P(E)} </script>
</p>
<p>Where <script type="math/tex">P(M)</script> is the <strong>prior</strong> probabillity belief of the model <script type="math/tex">M</script>, <script type="math/tex">P(E|M)</script> is the <strong>likelihood</strong> of observing evidence <script type="math/tex">E</script> given the model, <script type="math/tex">P(M|E)</script> is the <strong>posterior</strong> probabillity of the model given the evidence, and <script type="math/tex">P(E)</script> is the "marginalised likelihood" or the "evidence", which is the probabillity of observing the data set.</p>
<p>Bayesian inference can be used in physics to fit models to observed data, given only a prior belief on the parameters of the model. This has uses from astronomy to particle physics.</p>
<h2 id="markov-chain-monte-carlo">Markov Chain Monte Carlo</h2>
<p>The marginal likelihood <script type="math/tex">P(E)</script> is impossible to calculate analytically, so instead a method called <a href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo">Markov chain Monte Carlo (MCMC)</a> is employed. An MCMC algorithm has two components: Monte Carlo techniques imply that samples are randomly generated, and Markov Chain implies that the next step of the algorithm depends only on the current step.</p>
<p>The most popular MCMC algorithm is the <a href="https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm">MH algorithm</a>, which will completely ignore the <script type="math/tex">P(E)</script> term. Instead, on the <script type="math/tex">i</script>'th step of the algorithm, the sampler will randomly generate a proposal model <script type="math/tex">M^*</script> which may (or may not) do a better job at explaining the data than the current model <script type="math/tex">M^{i-1}</script>. The ratio of posteriors</p>
<p>
<script type="math/tex; mode=display"> r = \frac{P(E|M^*) P(M^*)}{P(E|M^{i-1}) P(M^{i-1})} = \frac{P(M^*|E)}{P(M^{i-1}|E)}</script>
</p>
<p>is then calculated, using the prior and likelihood distributions. This ratio describes which model is most likely to explain the data, and so the proposed model <script type="math/tex">M^*</script> will be accepted if this ratio is greater than 1. Otherwise, the accpetance probabillity is <script type="math/tex">P = r</script>.</p>
<h2 id="nested-sampling">Nested Sampling</h2>
<p><a href="https://en.wikipedia.org/wiki/Nested_sampling_algorithm">Nested sampling</a> algorithms are a variation on MCMC, which use numerical methods to calculate the marginal likelihood. The name "marginal likelihood" is literal, meaning that the evidence can be found as the integral of the likelihood with respect to the model (marginalising the model out). When models have tens or hundreds of parameters, this marginalisation becomes impossible. </p>
<p>A very simple nested sampling algorithm essentially uses the trapezium rule to estimate the value of the marginalisation integral. This is especially useful for comparing models, since the marginalised likelihood is a metric for how well a model describes a data set. For two models <script type="math/tex">M_1</script> and <script type="math/tex">M_2</script>, the <a href="https://en.wikipedia.org/wiki/Bayes_factor">Bayes' factor</a></p>
<p>
<script type="math/tex; mode=display"> K = \frac{P(E|M_1)}{P(E|M_2)} </script>
</p>
<p>describes whether or not <script type="math/tex">M_1</script> is a more likely model than <script type="math/tex">M_2</script> given the evidence <script type="math/tex">E</script>.</p>
<h2 id="the-samplers">The Samplers</h2>
<p>The following samplers are used in demonstrations on this site:</p>
<ul>
<li><a href="https://docs.pymc.io/">PyMC3</a></li>
<li><a href="https://dynesty.readthedocs.io/en/latest/">dynesty</a></li>
<li><a href="https://emcee.readthedocs.io/en/stable/">emcee</a></li>
<li><a href="https://johannesbuchner.github.io/UltraNest/index.html">UltraNest</a></li>
<li><a href="https://zeus-mcmc.readthedocs.io/en/latest/index.html">Zeus</a></li>
<li><a href="http://kylebarbary.com/nestle/">Nestle</a></li>
<li><a href="https://pystan.readthedocs.io/en/latest/">PyStan</a></li>
</ul>
<h2 id="the-data">The Data</h2>
<p>All the data used in these examples is open source, and publicly available on the following links:</p>
<ul>
<li><a href="https://drive.google.com/drive/folders/1ACd_hpip-n-_LwGM5fuHEp1Vvqg6emoH?usp=sharing">Gamma-ray spectroscopy of a source of Ba-133</a></li>
<li><a href="https://www.nasa.gov/kepler/education/getlightcurves">Exoplanet light curve from Kepler-10</a></li>
<li><a href="http://www.sidc.be/silso/datafiles">Average solar sunspot numbers since 1750</a></li>
<li><a href="https://gwpy.github.io/docs/stable/api/gwpy.timeseries.TimeSeries.html">Gravitational wave signal from GW150914</a></li>
<li><a href="https://archive.ics.uci.edu/ml/datasets/HIGGS">Particle invariant mass measurements from LHC</a></li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
        
          <a href="PyMC3_GRS/PyMC3_GRS/" title="Gamma-Ray Spectroscopy with PyMC3 and dynesty" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Gamma-Ray Spectroscopy with PyMC3 and dynesty
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.92ffa368.min.js"></script>
      <script src="assets/javascripts/bundle.5123e3d4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: [],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>